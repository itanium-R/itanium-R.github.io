<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="./fullScSlider/fullScSlider.js"></script>
  <script>
    var area,NS;
    function loadWeather(){
      window.open(
          `https://script.google.com/macros/s/AKfycbxOBOfpSsnApd0GMwPm2xCLlBmnksqqUkLMICRFldFDBLt7Uv8/exec?mode=w&area=${area}&NS=${NS}`
          ,"weather");
    }
    function loadRainRadar(){
      window.open(
          "https://tenki.jp/map/"
          ,"rainRadar");
    }
    function loadAdvisory(){
      window.open(
          "https://weathernews.jp/s/warn/kinki.html"
          ,"advisory");
    }
    window.onload = function(){
      area     = getParam("area");
      NS       = getParam("NS");
      slideDur = getParam("slideDur");
      if(!area)     area     = 333;
      if(!NS)       NS       = "S";
      if(!slideDur) slideDur = 10;

      loadWeather();loadRainRadar();loadAdvisory();
      setInterval(loadWeather, 1800000); // 30分ごとに更新
      setInterval(loadAdvisory, 600000); // 10分ごとに更新
      
      var mainFrames = [
        document.getElementById("weather"),
        document.getElementById("rainRadar"),
        document.getElementById("advisory")
      ];
      
      new FullScSlider(mainFrames,slideDur,5);
    };
    
    function getParam(name) {
      let url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }
  </script>
<title>always</title>
<style>
  body{
    margin:  0;
    padding: 0;
    background: #235;
  }
  iframe.fullSc{
    position: fixed;
    top: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    border:0;
  }
</style>
</head>
<body>
  <section id="main">
    <iframe class="fullSc" id="weather"   name="weather"   allowusermedia="true"></iframe>
    <iframe class="fullSc" id="rainRadar" name="rainRadar" allowusermedia="true"></iframe>
    <iframe class="fullSc" id="advisory"  name="advisory"  allowusermedia="true"></iframe>
  </section>

  <section id="trainTicker">
    <link href="./td-ticker-clock-b.css" rel="stylesheet" type="text/css">
    <script src="./td-ticker-b.js"></script>
  </section>

</body>
</html>
